<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>拖拽事件和键盘事件</title>
		<style type="text/css">
			html{
				width: 100%;
				height: 100%;
			}
			.box{
				width: 100px;
				height: 100px;
				background: red;
				border-radius: 50%;
				position: absolute;
				top: 0;
				left: 0;
			}
			.father{
				width: 600px;
				height: 400px;
				border: 1px solid black;
				position: relative;
				margin: 50px auto;
			}
			.child{
				width: 50px;
				height: 50px;
				background: #bfa;
				position: absolute;
				top: 0;
				left: 0;
			}
		</style>
	</head>
	<body>
		<div class="box"></div>
		<div class="father">
			<div class="child"></div>
		</div>
		<script>
			//鼠标事件
			var box=document.querySelector('.box');
			var flag,theX,theY;
//			console.log(document.documentElement.offsetHeight);
//			console.log(document.documentElement.clientHeight);
//			console.log(window.innerHeight);
			var H=document.documentElement.offsetHeight-box.offsetHeight;
			var W=document.documentElement.offsetWidth-box.offsetWidth;
//			var H=document.documentElement.clientHeight-box.offsetHeight;
//			var W=document.documentElement.clientWidth-box.offsetWidth;
//			var H=window.innerHeight-box.offsetHeight;
//			var W=window.innerWidth-box.offsetWidth;
			box.onmousedown=function(event){
				flag=true;
				var evt=event||window.event;
				theX=evt.clientX-box.offsetLeft;
				theY=evt.clientY-box.offsetTop;
			}
			document.onmousemove=function(event){
				var evt=event||window.event;
				if(flag){
					var curX=evt.clientX-theX;
					var curY=evt.clientY-theY;
					if(curX<0){
						curX=0;
					}else if(curX>W){
						curX=W;
					}
					if(curY<0){
						curY=0;
					}else if(curY>H){
						curY=H;
					}
					box.style.left=curX+'px';
					box.style.top=curY+'px';
				}
			}
			box.onmouseup=function(){
				flag=false;
			}
			//键盘事件
			var father=document.querySelector('.father');
			var child=document.querySelector('.child');
			var w=father.clientWidth-child.offsetWidth;
			var h=father.clientHeight-child.offsetHeight;
			var num=15,curX=0,curY=0;
			document.onkeydown=function(event){
				var evt=event||window.event;
				var x=parseFloat(getStyle(child,'left'));
				var y=parseFloat(getStyle(child,'top'));
				switch(evt.keyCode){
					case 37:
					curX=x-num;
					if(curX<0){
						curX=0;
					}
					child.style.left=curX+'px';	
					break;
					case 38:
					curY=y-num;
					if(curY<0){
						curY=0;
					}
					child.style.top=curY+'px';
					break;
					case 39:
					curX=x+num;
					if(curX>w){
						curX=w;
					}
					child.style.left=curX+'px';	
					break;
					case 40:
					curY=y+num;
					if(curY>h){
						curY=h;
					}
					child.style.top=curY+'px';	
					break;
				}
			}
			//获取元素样式值
			function getStyle(el,attr){
				if(window.getComputedStyle){
					return getComputedStyle(el,null)[attr];
				}else{
					return el.currentStyle[attr];
				}
			}
		</script>
	</body>
</html>
